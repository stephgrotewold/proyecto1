item_database_alcohol = [
    {'item_id': 1701, 'item_name': 'Jack Daniels', 'precio': 150, 'cantidad':50},
    {'item_id': 1702, 'item_name': 'RedBull', 'precio': 20, 'cantidad':80},
    {'item_id': 1703, 'item_name': 'Jagermeister','precio': 230, 'cantidad':100},
    {'item_id': 1704, 'item_name': 'Bailey', 'precio': 198, 'cantidad':60},
    {'item_id': 1705, 'item_name': 'XL', 'precio': 100, 'cantidad':35},
    {'item_id': 1706, 'item_name': 'Johnnie Walker','precio': 215, 'cantidad':40},
    {'item_id': 1707, 'item_name': 'Gallo', 'precio': 6, 'cantidad':45},
    {'item_id': 1708, 'item_name': 'Corona', 'precio': 7, 'cantidad':70},
    {'item_id': 1709, 'item_name': 'Bicardi','precio': 199, 'cantidad':80},
    {'item_id': 1710, 'item_name': 'San Miguel','precio': 205, 'cantidad':65},
    {'item_id': 1711, 'item_name': 'Smirnoff','precio': 110, 'cantidad':45},
]
item_database_bebidas = [
    {'item_id': 1101, 'item_name': 'Pepsi Black', 'precio': 20, 'cantidad':35},
    {'item_id': 1102, 'item_name': 'Sprite 2L', 'precio': 13, 'cantidad':10},
    {'item_id': 1103, 'item_name': 'Jugo de Naranja','precio': 36, 'cantidad':46},
    {'item_id': 1104, 'item_name': 'Jugo de Manzana', 'precio': 29, 'cantidad':89},
    {'item_id': 1105, 'item_name': 'Leche', 'precio': 14, 'cantidad':56},
    {'item_id': 1106, 'item_name': 'Pepsi','precio': 5, 'cantidad':90},
    {'item_id': 1107, 'item_name': 'Coca-cola', 'precio': 6, 'cantidad':130},
    {'item_id': 1108, 'item_name': '7up', 'precio': 7, 'cantidad':34},
    {'item_id': 1109, 'item_name': 'Grapette','precio': 8, 'cantidad':62},
    {'item_id': 1110, 'item_name': 'Gatorade','precio': 8, 'cantidad':30},
    {'item_id': 1111, 'item_name': 'Powerade','precio': 9, 'cantidad':45},
]
item_database_carnes = [
    {'item_id': 1201, 'item_name': 'Pollo', 'precio': 25, 'cantidad':6},
    {'item_id': 1202, 'item_name': 'Pescado', 'precio': 30, 'cantidad':55},
    {'item_id': 1203, 'item_name': 'Lomito','precio': 80, 'cantidad':16},
    {'item_id': 1204, 'item_name': 'Puyazo', 'precio': 100, 'cantidad':58},
    {'item_id': 1205, 'item_name': 'Costilla', 'precio': 110, 'cantidad':73},
    {'item_id': 1206, 'item_name': 'Cordero','precio': 40, 'cantidad':68},
    {'item_id': 1207, 'item_name': 'Milanesa', 'precio': 68, 'cantidad':74},
    {'item_id': 1208, 'item_name': 'Pechuga de Pavo', 'precio': 35, 'cantidad':37},
    {'item_id': 1209, 'item_name': 'Chuleta','precio': 60, 'cantidad':65},
    {'item_id': 1210, 'item_name': 'Tocino','precio': 23, 'cantidad':60},
    {'item_id': 1211, 'item_name': 'Salchicha','precio': 15, 'cantidad':61},
]

item_database_panaderia = [
    {'item_id': 1301, 'item_name': 'Pan de agua', 'precio': 4, 'cantidad':30},
    {'item_id': 1302, 'item_name': 'Pan frances', 'precio': 9, 'cantidad':37},
    {'item_id': 1303, 'item_name': 'Pan sandwich','precio': 17, 'cantidad':19},
    {'item_id': 1304, 'item_name': 'Baguette', 'precio': 10, 'cantidad':45},
    {'item_id': 1305, 'item_name': 'Pan ciabatta', 'precio': 22, 'cantidad':9},
    {'item_id': 1306, 'item_name': 'Pan de especies','precio': 9, 'cantidad':4},
    {'item_id': 1307, 'item_name': 'Pan de papa', 'precio': 5, 'cantidad':34},
    {'item_id': 1308, 'item_name': 'Pan pita', 'precio': 17, 'cantidad':21},
    {'item_id': 1309, 'item_name': 'Bagel','precio': 12, 'cantidad':2},
    {'item_id': 1310, 'item_name': 'Pan para hot dog','precio': 16, 'cantidad':28},
    {'item_id': 1311, 'item_name': 'Pan integral','precio': 14, 'cantidad':48},
]
item_database_frutas_verduras = [
    {'item_id': 1401, 'item_name': 'Manzana', 'precio': 6, 'cantidad':19},
    {'item_id': 1402, 'item_name': 'Pera', 'precio': 10, 'cantidad':10},
    {'item_id': 1403, 'item_name': 'Tomate','precio': 8, 'cantidad':39},
    {'item_id': 1404, 'item_name': 'Aguacate', 'precio': 12, 'cantidad':31},
    {'item_id': 1405, 'item_name': 'Papa', 'precio': 25, 'cantidad':3},
    {'item_id': 1406, 'item_name': 'Kiwi','precio': 1, 'cantidad':26},
    {'item_id': 1407, 'item_name': 'Brocoli', 'precio': 7, 'cantidad':20},
    {'item_id': 1408, 'item_name': 'Esparragos', 'precio': 6, 'cantidad':14},
    {'item_id': 1409, 'item_name': 'Uvas','precio': 13, 'cantidad':28},
    {'item_id': 1410, 'item_name': 'Naranja','precio': 4, 'cantidad':25},
    {'item_id': 1411, 'item_name': 'Lechuga','precio': 8, 'cantidad':4},
]

item_database_hogar = [
    {'item_id': 1501, 'item_name': 'Cloro', 'precio': 20, 'cantidad':11},
    {'item_id': 1502, 'item_name': 'Shampoo', 'precio': 29, 'cantidad':44},
    {'item_id': 1503, 'item_name': 'Escoba','precio': 9, 'cantidad':19},
    {'item_id': 1504, 'item_name': 'Concentrado para perro', 'precio': 40, 'cantidad':31},
    {'item_id': 1505, 'item_name': 'Canasta', 'precio': 13, 'cantidad':16},
    {'item_id': 1506, 'item_name': 'Detergente','precio': 28, 'cantidad':28},
    {'item_id': 1507, 'item_name': 'Suavizante', 'precio': 24, 'cantidad':16},
    {'item_id': 1508, 'item_name': 'Laysol', 'precio': 21, 'cantidad':19},
    {'item_id': 1509, 'item_name': 'Baygon','precio': 16, 'cantidad':37},
    {'item_id': 1510, 'item_name': 'Bolsas para basura','precio': 11, 'cantidad':14},
    {'item_id': 1511, 'item_name': 'Acondicionador','precio': 34, 'cantidad':44},
]
item_database_carrito=[]

class inventario:
    pass
p = inventario()

class Node:
    def __init__(self, data):
        self.data = data
        self.next = None


class SinglyLinkedList:
    def __init__(self, head):
        self.head = head

    def insert(self, data, position,ll):
        new_node=Node(data)
        if position==0:
            new_node.next=ll.head
            ll.head=new_node
        else:
            current=ll.head
            k=1
            while current.next is not None and k < position:
                current=current.next
                k+=1
            new_node.next=current.next
            current.next=new_node

    def delete(self, position):
        if position!=1:
            current=self.head
            k = 1
            while current.next is not None and k < position - 1:
                current=current.next
                k+=1
            if current.next is not None:
                current.next=current.next.next
                return True
            else:
                return False
        else:
            self.head=self.head.next
            return True
    def deleteAllNodes(self):
        while (self.head != None):
            temp = self.head
            self.head = self.head.next
            temp = None


def sum_cantidad(pid,pc,db):
    if(type(pid) not in[int] or type(pc) not in[int]):
        raise TypeError('ID o Cantidad no son enteros')
    else:
        for item in db:
            if item['item_id']==pid:
                item['cantidad']=int(item['cantidad'])+pc
                return 1
        return 0
def rest_cantidad(pid,pc,db):
    if(type(pid) not in[int] or type(pc) not in[int]):
        raise TypeError('ID o Cantidad no son enteros')
    else:
        for item in db:
            if item['item_id']==pid:
                if(int(item['cantidad'])<pc):
                    return 0
                else:
                    item['cantidad']=int(item['cantidad'])-pc
                    return 1   
        return 0
def edit_name(pid,nombre,db):
    if(type(pid) not in[int]):
        raise TypeError('ID debe ser un entero')
    for item in db:
        if item['item_id']==pid:
            item['item_name']=nombre
            return print('Nombre actualizado con exito')
    return print('Error, ID no encontrada')

def edit_precio(pid,presio,db):
    if(type(pid) not in[int] or type(presio) not in[int]):
        raise TypeError('ID o Precio deben ser enteros')
    for item in db:
        if item['item_id']==pid:
            item['precio']=presio
            return 1
    return 0
def edit_cant(pid,cantida,db):
    if(type(pid) not in[int] or type(cantida) not in[int]):
        raise TypeError('ID o Cantidad deben ser enteros')
    for item in db:
        if item['item_id']==pid:
            item['cantidad']=cantida
            return 1
    return 0
def elim_item(pid,db):
    if(type(pid) not in[int]):
        raise TypeError('ID debe ser un entero')
    cont=0
    for item in db:
        if item['item_id']==pid:
            db.pop(cont)
            return 1
        cont=cont+1
    return 0
def search_id(id2):
    if(type(id2) not in[int]):
        raise TypeError('ID solo puede ser un entero')
    else:
        if(id2>1099 and id2<1200):
            return item_database_bebidas
        if(id2>1199 and id2<1300):
            return item_database_carnes
        if(id2>1299 and id2<1400):
            return item_database_panaderia
        if(id2>1399 and id2<1500):
            return item_database_frutas_verduras
        if(id2>1499 and id2<1600):
            return item_database_hogar
        if(id2>1699 and id2<1800):
            return item_database_alcohol
        return 0
def search_name(name1):
    for item in item_database_bebidas:
        if item['item_name']==name1:
            return item_database_bebidas
    for item in item_database_carnes:
        if item['item_name']==name1:
            return item_database_carnes
    for item in item_database_panaderia:
        if item['item_name']==name1:
            return item_database_panaderia
    for item in item_database_frutas_verduras:
        if item['item_name']==name1:
            return item_database_frutas_verduras
    for item in item_database_hogar:
        if item['item_name']==name1:
            return item_database_hogar
    for item in item_database_alcohol:
        if item['item_name']==name1:
            return item_database_alcohol
    return 0
def verify_id(pid,db):
    if(type(pid) not in[int]):
        raise TypeError('Ingrese un entero')
    for item in db:
        if item['item_id']==pid:
            return 0
    return 1
def verify_name(pname,quant,datab):
    if(type(quant) not in[int]):
        raise TypeError('Cantidad debe ser un entero')
    for item in datab:
        if item['item_name']==pname:
            if item['cantidad']>=quant:
                return item['item_id']
    return 0
def total(pname,pc,db):
    if(type(pc) not in[int]):
        raise TypeError('Cantidad debe ser un entero')
    for item in db:
        if item['item_name']==pname:
            return pc*item['precio']
def saldar(pname,pc,db):
    if(type(pc) not in[int]):
        print('Error')
    for item in db:
        if item['item_name']==pname:
            item['cantidad']=item['cantidad']+pc
def search_carrito(name1):
    for item in item_database_carrito:
        if item['item_name']==name1:
            return 1
    return 0
def search_cant(name1):
    for item in item_database_carrito:
        if item['item_name'] == name1:
            return item['cantidad']
def positivo(num):
    if(type(num) not in[int]):
        raise TypeError('Debe ingresar un entero')
    if(num>0):
        return 1
    else:
        return 0

opcion=0
opcion1=0
opcion2=0
usuario = "admin"
cabesa=0
cont=0
acu=1
tot=0
ids=[]
pagos=[]
opcioncompra=0
contra= "contrasena"
while(opcion!=3):
    
    print('Ingrese que operación desea realizar \n')
    print('1. Comprar\n')
    print('2. Ver inventario (requiere autenticación) \n')
    print('3. Salir \n')
    try:
        opcion=int(input("\n"))
    except:
        print('Error')
    else:
        if opcion==1:
            while opcioncompra!=5:
                if cont==0:
                    cabesa=0
                print('1. Agregar productos al carrito')
                print('2. Eliminar productos del carrito')
                print('3. Mostrar carreta')
                print('4. Checkout')
                print('5. Salir')
                try:
                    opcioncompra=int(input('Ingrese la opción que desea realizar \n'))
                except:
                    print('Ingrese un numero')
                if(opcioncompra==1):
                    namecompra=''
                    while namecompra=='':
                        print('Productos disponibles')
                        print('\n Bebidas \n')
                        for x in item_database_bebidas:
                                        print(x)
                        print('\n Carnes \n')
                        for x in item_database_carnes:
                                        print(x)
                        print('\n Panitos \n')
                        for x in item_database_panaderia:
                                        print(x)
                        print('\n Frutas y verduras \n')
                        for x in item_database_frutas_verduras:
                                        print(x)
                        print('\n Hogar \n')
                        for x in item_database_hogar:
                                        print(x)
                        print('\n Alcohol \n')
                        for x in item_database_alcohol:
                                        print(x)
                        namecompra=(input("\n Ingrese el nombre del producto a comprar\n"))
                        try:
                            cantidadcompra=int(input('Ingrese la cantidad del producto a comprar \n'))
                        except:
                            print('Error')
                        else:
                            if(positivo(cantidadcompra)==1):
                                seccion=search_name(namecompra)
                                if(seccion==0):
                                    print('Ingrese el nombre de un producto existente')
                                else:
                                    if(verify_name(namecompra,cantidadcompra,seccion)==0):
                                        print('No hay cantidad suficiente de productos')
                                    else:
                            
                                        if cabesa==0:
                                            checkout=1
                                            items_comprados = SinglyLinkedList(Node(namecompra))
                                            for i in range(2,50):
                                                items_comprados.insert(i, i-1,items_comprados)
                                            cabesa=1
                                            cont=cont+1
                                            rest_cantidad(verify_name(namecompra,cantidadcompra,seccion),cantidadcompra,seccion)
                                            item_database_carrito.append({'item_name': namecompra, 'cantidad':cantidadcompra, 'pasillo':seccion })
                                            pagos.append(total(namecompra,cantidadcompra,seccion))
                                        else:
                                            if(search_carrito(namecompra)==1):
                                                print('Este producto ya se encuentra en el carrito')
                                            else:
                                                rest_cantidad(verify_name(namecompra,cantidadcompra,seccion),cantidadcompra,seccion)
                                                item_database_carrito.append({'item_name': namecompra, 'cantidad':cantidadcompra, 'pasillo':seccion })
                                                items_comprados.insert(namecompra, cont, items_comprados)
                                                pagos.append(total(namecompra,cantidadcompra,seccion))
                                                cont=cont+1
                            else:
                                print('Ingrese un numero positivo')
                if(opcioncompra==2):
                    if(cabesa==0):
                        print('Carrito vacío')
                    else:
                        current = items_comprados.head
                        acu=1
                        for i in range(cont):
                            print(acu,'. ', current.data)
                            acu=acu+1
                            current = current.next
                        try:
                            numelim=int(input('Ingrese el numero del producto a eliminar de la carreta \n'))
                        except:
                            print('Error')
                        else:
                            if(numelim>acu-1 or numelim<1):
                                print('Ingrese un número valido')
                            else:
                                current = items_comprados.head
                                for i in range(cont):
                                    if(search_carrito(current.data)==1):
                                        saldar(current.data, search_cant(current.data), search_name(current.data))
                                        item_database_carrito.pop(numelim-1)
                                    current = current.next
                                items_comprados.delete(numelim)
                                cont=cont-1
                                pagos.pop(numelim-1)
                                print('Producto eliminado exitosamente \n')
                if(opcioncompra==3):
                    if cabesa==0:
                        print('Carrito vacio')
                    else:
                        current = items_comprados.head
                        acu=1
                        for i in range(cont):
                            print(acu,'. ', current.data)
                            acu=acu+1
                    
                            current = current.next
                        for x in pagos:
                            tot=tot+x
                        print('Total a pagar: ', tot, '\n')
                        tot=0
                if(opcioncompra==4):
                    if(cabesa==0):
                        print('Carrito vacio')
                    else:
                        print('Productos en el carrito: \n')
                        current = items_comprados.head
                        acu=1
                        for i in range(cont):
                            print(acu,'. ', current.data)
                            acu=acu+1
                        
                            current = current.next

                        for x in pagos:
                            tot=tot+x
                        print('Total a pagar: ', tot, '\n')
                        tot=0
                        pagos.clear()
                        item_database_carrito.clear()
                        items_comprados.deleteAllNodes()
                        print('Gracias por su compra \n')
                        cabesa=0
                        cont=0
                if(opcioncompra>5 or opcioncompra<1):
                    print('Ingrese una opción valida')
        if opcion==2:
            user=input("Ingrese su usuario \n")
            password=input("Ingrese su contraseña \n")
            if user==usuario and password==contra:
                opcion1=0
                while(opcion1!=7):
                    print('1. Añadir productos')
                    print('2. Remover productos')
                    print('3. Modificar productos')
                    print('4. Mostrar productos')
                    print('5. Añadir un item')
                    print('6. Eliminar un item')
                    print('7. Salir')
                    try:
                        opcion1=int(input('Ingrese la opcion a realizar '))
                    except:
                        print('Error')
                    else:
                        if(opcion1==1):
                            try:
                                idpro=int(input('Ingrese el id del producto \n'))
                                cantsum=int(input('Ingrese la cantidad del producto a añadir \n'))
                            except:
                                print('Error')
                            else:
                                if(positivo(cantsum)==1):
                                    seccion=search_id((idpro))
                                    if(seccion==0):
                                        print('Ingrese un ID valido')
                                    else:
                                        if(sum_cantidad(idpro,cantsum,seccion)==0):
                                            print('Ingrese un numero valido')
                                        else:
                                            print('Cantidad actualizada con exito')
                                else:
                                    print('Ingrese una cantidad positiva')
                        if(opcion1==2):
                            try:
                                idpro=int(input('Ingrese el id del producto \n'))
                                cantrest=int(input('Ingrese la cantidad del producto a reducir \n'))
                            except:
                                print('Error')
                            else:
                                if(positivo(cantrest)==1):
                                    seccion=search_id(idpro)
                                    if(seccion==0):
                                        print('Ingrese un ID valido')
                                    else:
                                        if(rest_cantidad(idpro, cantrest, seccion)==0):
                                            print('Error, no hay suficientes productos')
                                        else:
                                            print('Cantidad actualizada con exito')
                                else:
                                    print('Ingrese un numero positivo')
                        if(opcion1==3):
                            opcion2=0
                            while(opcion2!=4):
                                print('1. Modificar nombre')
                                print('2. Modificar precio')
                                print('3. Modificar cantidad')
                                print('4. Salir')
                                try:
                                    opcion2=int(input('Ingrese la opcion a realaizar \n'))
                                except:
                                    print('Error')
                                else:
                                    if(opcion2==1):
                                        try:
                                            idpro=int(input('Ingrese el ID del producto \n'))
                                        except:
                                            print('Error')
                                        else:
                                            seccion=search_id(idpro)
                                            if(seccion==0):
                                                print('Ingrese un ID valido')
                                            else:
                                                namepro=(input('Ingrse el nuevo nombre del producto \n'))
                                                if(edit_name(idpro,namepro,seccion)==1):
                                                    print('Nombre actualizado con exito')

                                    if(opcion2==2):
                                        try:
                                            idpro=int(input('Ingrese el ID del producto \n'))
                                            preciopro=int(input('Ingrese el nuevo precio \n'))
                                        except:
                                            print('Error')
                                        else:
                                            if(positivo(preciopro)==1):
                                                seccion=search_id(idpro)
                                                if(seccion==0):
                                                    print('Ingrese un ID valido')
                                                else:
                                                    if(edit_precio(idpro,preciopro,seccion)==1):
                                                        print('Precio actualizado con exito')
                                            else:
                                                print('Ingrese un número positivo')
                                    if(opcion2==3):
                                        try:
                                            idpro=int(input('Ingrese el ID del producto \n'))
                                            cantidadpro=int(input('Ingrese la nueva cantidad del producto \n'))
                                        except:
                                            print('Error')
                                        else:
                                            if(positivo(cantidadpro)==1):
                                                seccion=search_id(idpro)
                                                if(seccion==0):
                                                    print('Ingrese un ID valido')
                                                else:
                                                    if(edit_cant(idpro,cantidadpro,seccion)==1):
                                                        print('Cantidad actualizada con exito')
                                            else:
                                                print('Ingrese un numero positivo')
                                    if(opcion2<1 or opcion2>4):
                                        print('Ingrese una opción valida')
                        if(opcion1==4):
                            print('1. Alcohol')
                            print('2. Bebidas')
                            print('3. Carnes')
                            print('4. Panaderia')
                            print('5. Frutas y verduras')
                            print('6. Hogar')
                            print('7. Todas')
                            try:
                                categoria=int(input('Ingrese el numero de la seccion que desea revisar \n'))
                            except:
                                print('Error')
                            else:
                                if(categoria==1):
                                    for x in item_database_alcohol:
                                        print(x)
                                if(categoria==2):
                                    for x in item_database_bebidas:
                                        print(x)
                                if(categoria==3):
                                    for x in item_database_carnes:
                                        print(x)
                                if(categoria==4):
                                    for x in item_database_panaderia:
                                        print(x)
                                if(categoria==5):
                                    for x in item_database_frutas_verduras:
                                        print(x)
                                if(categoria==6):
                                    for x in item_database_hogar:
                                        print(x)
                                if(categoria==7):
                                    print('\n Alcohol \n')
                                    for x in item_database_alcohol:
                                        print(x)
                                    print('\n Bebidas \n')
                                    for x in item_database_bebidas:
                                        print(x)
                                    print('\n Carnes \n')
                                    for x in item_database_carnes:
                                        print(x)
                                    print('\n Panaderia \n')
                                    for x in item_database_panaderia:
                                        print(x)
                                    print('\n Frutas y verduras \n')
                                    for x in item_database_frutas_verduras:
                                        print(x)
                                    print('\n Hogar \n')
                                    for x in item_database_hogar:
                                        print(x)
                                    print('\n')
                                if(categoria<1 and categoria>7):
                                    print('Ingrese un numero valido')

                        if(opcion1==5):
                            try:
                                id=int(input('Ingrese el ID del nuevo producto \n'))
                                name=input('Ingrese el nombre del nuevo producto \n')
                                price=int(input('Ingrese el precio del nuevo producto \n'))
                                quantity=int(input('Ingrese la cantidad del nuevo producto \n'))
                            except:
                                print('Error')
                            else:
                                if(positivo(quantity)==1 and positivo(price)==1):
                                    seccion=search_id(id)
                                    if(seccion==0):
                                        print('Ingrese un ID valido')
                                    else:
                                        existente=verify_id(id,seccion)
                                        if(existente==0):
                                            print('ID ya existente')
                                        else: 
                                            seccion.append({'item_id': id, 'item_name': name, 'precio': price, 'cantidad': quantity})
                                            print('Producto ingresado con exito')
                                else:
                                    print('Ingrese número positivos')
                        if(opcion1==6):
                            try:
                                id=(int(input('Ingrese el ID del producto a eliminar \n')))
                            except:
                                print('Error')
                            else:
                                seccion=search_id(id)
                                if(seccion==0):
                                    print('Ingrese un ID valido')
                                else:
                                    if(elim_item(id,seccion)==1):
                                        print('Item eliminado con exito')
                        if(opcion1<1 and opcion1>6):
                            print('Ingrese una opcion valida')
            else:
                print("Usuario o contraseña incorrecta")
    
        if opcion!=1 and opcion!=2 and opcion!=3:
            print('Ingrese una opción valida')
    

